<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="assets_frontend" inherit_id="website.assets_frontend" name="Website Sale Layout frontend assets">
            <xpath expr="." position="inside">
                <link rel='stylesheet' href='/website_sale_layout/static/src/css/website_sale_layout.css'/>
            </xpath>
        </template>
        
        <template id="website_sale_layout_pricing" inherit_id="website_quote.pricing">
            <xpath expr="//section/table/tbody" position="replace">
            <tbody>
                <t t-foreach="quotation.sale_layout_lines(quotation.id)" t-as="p">
                    <t t-call="website_sale_layout.category_template" />
                    <t t-foreach="p['lines']" t-as="line">
                    <tr>
                      <td>
                            <div t-field="line.product_id.name"/>
                            <div t-field="line.name" class="text-muted"/>
                      </td>
                      <td>
                          <div id="quote_qty">
                              <span t-field="line.product_uom_qty"/>
                              <span t-field="line.product_uom"/>
                          </div>
                      </td>
                      <td>
                          <div t-foreach="line.tax_id" t-as="tax">
                              <t t-esc="tax.name"/>
                          </div>
                      </td>
                      <td>
                          <strong t-if="line.discount" class="text-info">
                              <t t-esc="((line.discount % 1) and '%s' or '%d') % line.discount"/>% discount
                          </strong>
                      </td>
                      <td class="o_width16">
                          <strong class="text-right">
                              <div t-field="line.price_unit"
                                  t-field-options='{"widget": "monetary", "display_currency": "quotation.pricelist_id.currency_id"}'
                                  t-att-style="line.discount and 'text-decoration: line-through' or ''"
                                  t-att-class="line.discount and 'text-danger' or ''"/>
                              <div t-if="line.discount">
                                  <t t-esc="'%.2f' % ((1-line.discount / 100.0) * line.price_unit)"/>
                              </div>
                          </strong>
                      </td>
                      <td class="o_width20">
                          <div class="text-right"
                              t-field="line.price_subtotal"
                              t-field-options='{"widget": "monetary", "display_currency": "quotation.pricelist_id.currency_id"}'/>
                      </td>
                      <td>
                          <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;unlink=True&amp;token=#{ quotation.access_token }" class="mb8 js_update_line_json pull-right hidden-print" t-if="line.option_line_id">
                              <span class="fa fa-trash-o"></span>
                          </a>
                      </td>
                    </tr>
                    </t>
                    <t t-call="website_sale_layout.subtotal_template" />
                    <tr class="text-center">
                        <td colspan="100">
                            ***
                        </td>
                    </tr>
                </t>
                <tr>
                    <td></td><td></td><td></td><td></td>
                    <td class="text-right"><strong>Subtotal:</strong></td>
                    <td class="text-right o_width20">
                        <strong data-id="total_amount" t-field="quotation.amount_untaxed" t-field-options='{"widget": "monetary","display_currency": "quotation.pricelist_id.currency_id"}'/>
                    </td>
                </tr>
                <tr>
                    <td></td><td></td><td></td><td></td>
                    <td class="text-right">Taxes:</td>
                    <td class="text-right o_width20">
                        <span data-id="total_amount" t-field="quotation.amount_tax" t-field-options='{"widget": "monetary","display_currency": "quotation.pricelist_id.currency_id"}'/>
                    </td>
                </tr>
                <tr>
                    <td></td><td></td><td></td><td></td>
                    <td class="text-right"><strong>Total:</strong></td>
                    <td class="text-right o_width20">
                        <strong data-id="total_amount" t-field="quotation.amount_total" t-field-options='{"widget": "monetary","display_currency": "quotation.pricelist_id.currency_id"}'/>
                    </td>
                </tr>
              </tbody>
            </xpath>
       </template>
    </data>
</openerp>